import{r as t,u as Le,a as Be,b as te,j as e,c as z,d as Fe,e as We,f as He,g as Ue,h as me,t as Xe,m as fe,A as xe,T as ze,i as Ke,R as qe,S as ge,k as Ge,l as Ve,n as O,o as Ye,p as Je,q as Ze,s as Qe,v as es,I as ss,C as ts,w as ns,x as rs,y as as,z as cs,B as is,D as ls,E as os,M as ds,F as us,G as hs,H as ms,J as pe,K as X,L as je,N as fs,O as xs}from"./index-VLfZ_LXD.js";import{T as ps}from"./Table-yTzlROhX.js";import{M as J}from"./Modal-BoySAo34.js";function js(r,n){const l=t.useRef(!0);t.useEffect(()=>{if(l.current){l.current=!1;return}return r()},n)}const se=2**31-1;function Ne(r,n,l){const h=l-Date.now();r.current=h<=se?setTimeout(n,h):setTimeout(()=>Ne(r,n,l),se)}function vs(){const r=Le(),n=t.useRef();return Be(()=>clearTimeout(n.current)),t.useMemo(()=>{const l=()=>clearTimeout(n.current);function h(m,o=0){r()&&(l(),o<=se?n.current=setTimeout(m,o):Ne(n,m,Date.now()+o))}return{set:h,clear:l,handleRef:n}},[])}const Ce=t.forwardRef(({className:r,bsPrefix:n,as:l="div",...h},m)=>(n=te(n,"carousel-caption"),e.jsx(l,{ref:m,className:z(r,n),...h})));Ce.displayName="CarouselCaption";const we=t.forwardRef(({as:r="div",bsPrefix:n,className:l,...h},m)=>{const o=z(l,te(n,"carousel-item"));return e.jsx(r,{ref:m,...h,className:o})});we.displayName="CarouselItem";const gs=40;function Ns(r){if(!r||!r.style||!r.parentNode||!r.parentNode.style)return!1;const n=getComputedStyle(r);return n.display!=="none"&&n.visibility!=="hidden"&&getComputedStyle(r.parentNode).display!=="none"}const ye=t.forwardRef(({defaultActiveIndex:r=0,...n},l)=>{const{as:h="div",bsPrefix:m,slide:o=!0,fade:c=!1,controls:K=!0,indicators:p=!0,indicatorLabels:L=[],activeIndex:j,onSelect:v,onSlide:S,onSlid:b,interval:d=5e3,keyboard:D=!0,onKeyDown:A,pause:C="hover",onMouseOver:B,onMouseOut:F,wrap:k=!0,touch:q=!0,onTouchStart:W,onTouchMove:H,onTouchEnd:R,prevIcon:G=e.jsx("span",{"aria-hidden":"true",className:"carousel-control-prev-icon"}),prevLabel:E="Previous",nextIcon:Z=e.jsx("span",{"aria-hidden":"true",className:"carousel-control-next-icon"}),nextLabel:i="Next",variant:f,className:I,children:x,...Se}=Fe({defaultActiveIndex:r,...n},{activeIndex:"onSelect"}),w=te(m,"carousel"),P=We(),_=t.useRef(null),[ne,re]=t.useState("next"),[be,V]=t.useState(!1),[$,ae]=t.useState(!1),[u,Re]=t.useState(j||0);t.useEffect(()=>{!$&&j!==u&&(_.current?re(_.current):re((j||0)>u?"next":"prev"),o&&ae(!0),Re(j||0))},[j,$,u,o]),t.useEffect(()=>{_.current&&(_.current=null)});let T=0,ce;He(x,(s,a)=>{++T,a===j&&(ce=s.props.interval)});const ie=Ue(ce),g=t.useCallback(s=>{if($)return;let a=u-1;if(a<0){if(!k)return;a=T-1}_.current="prev",v==null||v(a,s)},[$,u,v,k,T]),N=me(s=>{if($)return;let a=u+1;if(a>=T){if(!k)return;a=0}_.current="next",v==null||v(a,s)}),Q=t.useRef();t.useImperativeHandle(l,()=>({element:Q.current,prev:g,next:N}));const le=me(()=>{!document.hidden&&Ns(Q.current)&&(P?g():N())}),M=ne==="next"?"start":"end";js(()=>{o||(S==null||S(u,M),b==null||b(u,M))},[u]);const Ie=`${w}-item-${ne}`,ke=`${w}-item-${M}`,Ee=t.useCallback(s=>{Xe(s),S==null||S(u,M)},[S,u,M]),Te=t.useCallback(()=>{ae(!1),b==null||b(u,M)},[b,u,M]),Me=t.useCallback(s=>{if(D&&!/input|textarea/i.test(s.target.tagName))switch(s.key){case"ArrowLeft":s.preventDefault(),P?N(s):g(s);return;case"ArrowRight":s.preventDefault(),P?g(s):N(s);return}A==null||A(s)},[D,A,g,N,P]),Oe=t.useCallback(s=>{C==="hover"&&V(!0),B==null||B(s)},[C,B]),De=t.useCallback(s=>{V(!1),F==null||F(s)},[F]),oe=t.useRef(0),Y=t.useRef(0),de=vs(),Ae=t.useCallback(s=>{oe.current=s.touches[0].clientX,Y.current=0,C==="hover"&&V(!0),W==null||W(s)},[C,W]),Pe=t.useCallback(s=>{s.touches&&s.touches.length>1?Y.current=0:Y.current=s.touches[0].clientX-oe.current,H==null||H(s)},[H]),_e=t.useCallback(s=>{if(q){const a=Y.current;Math.abs(a)>gs&&(a>0?g(s):N(s))}C==="hover"&&de.set(()=>{V(!1)},d||void 0),R==null||R(s)},[q,C,g,N,de,d,R]),ue=d!=null&&!be&&!$,ee=t.useRef();t.useEffect(()=>{var s,a;if(!ue)return;const y=P?g:N;return ee.current=window.setInterval(document.visibilityState?le:y,(s=(a=ie.current)!=null?a:d)!=null?s:void 0),()=>{ee.current!==null&&clearInterval(ee.current)}},[ue,g,N,ie,d,le,P]);const he=t.useMemo(()=>p&&Array.from({length:T},(s,a)=>y=>{v==null||v(a,y)}),[p,T,v]);return e.jsxs(h,{ref:Q,...Se,onKeyDown:Me,onMouseOver:Oe,onMouseOut:De,onTouchStart:Ae,onTouchMove:Pe,onTouchEnd:_e,className:z(I,w,o&&"slide",c&&`${w}-fade`,f&&`${w}-${f}`),children:[p&&e.jsx("div",{className:`${w}-indicators`,children:fe(x,(s,a)=>e.jsx("button",{type:"button","data-bs-target":"","aria-label":L!=null&&L.length?L[a]:`Slide ${a+1}`,className:a===u?"active":void 0,onClick:he?he[a]:void 0,"aria-current":a===u},a))}),e.jsx("div",{className:`${w}-inner`,children:fe(x,(s,a)=>{const y=a===u;return o?e.jsx(ze,{in:y,onEnter:y?Ee:void 0,onEntered:y?Te:void 0,addEndListener:Ke,children:(U,$e)=>t.cloneElement(s,{...$e,className:z(s.props.className,y&&U!=="entered"&&Ie,(U==="entered"||U==="exiting")&&"active",(U==="entering"||U==="exiting")&&ke)})}):t.cloneElement(s,{className:z(s.props.className,y&&"active")})})}),K&&e.jsxs(e.Fragment,{children:[(k||j!==0)&&e.jsxs(xe,{className:`${w}-control-prev`,onClick:g,children:[G,E&&e.jsx("span",{className:"visually-hidden",children:E})]}),(k||j!==T-1)&&e.jsxs(xe,{className:`${w}-control-next`,onClick:N,children:[Z,i&&e.jsx("span",{className:"visually-hidden",children:i})]})]})]})});ye.displayName="Carousel";const ve=Object.assign(ye,{Caption:Ce,Item:we}),Cs=({reviews:r})=>(console.log(r),e.jsx("div",{children:e.jsxs("div",{class:"container container-fluid",children:[e.jsx("h4",{className:"mt-5",children:"Other's Reviews:"}),e.jsxs("div",{class:"reviews w-100",children:[e.jsx("hr",{}),r&&r.map(n=>{var l,h,m;return e.jsxs("div",{children:[e.jsxs("div",{className:"review-container",children:[e.jsxs("div",{className:"review-user-info",children:[e.jsx("img",{src:(l=n.user)==null?void 0:l.avatar,width:"40",height:"40",className:"review-avatar",alt:""}),e.jsxs("div",{className:"review-user-details d-flex",children:[e.jsx("p",{className:"review-user-name",children:(h=n.user)==null?void 0:h.name})," ",e.jsxs("p",{className:"review-user-email",children:["(",(m=n.user)==null?void 0:m.email,")"]})]})]}),e.jsx(ge,{rating:n.rating}),e.jsx("p",{className:"review-comment",children:n==null?void 0:n.comment})]}),e.jsx("hr",{className:"review-divider"})]},n._id)})]})]})})),ws=qe.memo(Cs),Rs=()=>{const{enqueueSnackbar:r}=Ge(),[n,l]=t.useState(!1),h=()=>l(!0),m=()=>l(!1),{id:o}=Ve(),c=O(Ye),K=O(Je),p=O(Ze),L=O(Qe),[j,v]=t.useState(1),[S,b]=t.useState(""),d=es(),D=O(ss);t.useEffect(()=>{D&&(m(),r("Review Submitted Successfully!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"center"},onExited:()=>{d(ts())}})),p&&r(p,{variant:"error",anchorOrigin:{vertical:"top",horizontal:"center"},onExited:()=>{d(ns())}}),(!c||D)&&d(rs(o))},[d,o,D,p]),t.useEffect(()=>{if(p){r(p,{variant:"error",anchorOrigin:{vertical:"top",horizontal:"center"}});return}return()=>{d(as())}},[p]);const[A,C]=t.useState(1),B=()=>{C(i=>c.stock===0||i>=c.stock?i:i+1)},F=()=>{C(i=>i===1?i:i-1)},k=i=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(i),q=()=>{d(fs({productId:c._id,quantity:A})),r("Cart Item Added!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"center"}})},W=()=>{const i=new FormData;i.append("rating",j),i.append("comment",S),i.append("productId",o),d(xs(i)),b(""),v("")},H=O(cs),R=O(is);t.useEffect(()=>(d(ls()),()=>{d(os())}),[d]);const G=t.useMemo(()=>{var f;const i=new Set;for(const I of R)for(const x of I.orderItems)((f=x.productId)==null?void 0:f._id)===o&&(x.status==="success"||x.status==="Success")&&i.add(x.productId._id);return i},[R,o]),E=t.useMemo(()=>G.has(o),[G,o]);t.useEffect(()=>{R.length>0&&console.log(E)},[R,E]),console.log(E);const Z=i=>e.jsx(e.Fragment,{children:c&&e.jsx(hs,{className:"my-5",style:{minHeight:"100vh"},children:e.jsxs(ms,{className:"justify-content-between mt-5 pt-5",children:[e.jsx(pe,{xs:12,lg:5,className:"text-center d-flex align-items-start justify-content-center",children:e.jsx(ve,{pause:"hover",children:c.images.map((f,I)=>e.jsx(ve.Item,{children:e.jsx("img",{src:f.image,alt:`image-${I}`,className:"d-block w-100",style:{width:"100%",height:"400px"}})},I))})}),e.jsxs(pe,{xs:12,lg:7,className:"mt-5 mt-lg-0",children:[e.jsx("h3",{children:c.name}),c.reviews.length>0&&e.jsxs("div",{className:"d-flex align-items-center",children:[" ",e.jsx(ge,{rating:c.ratings}),e.jsxs("span",{id:"no_of_reviews",className:"ml-2",children:["(",c.reviews.length," Ratings)"]})]}),e.jsx("hr",{}),e.jsx("p",{id:"product_price",className:"font-weight-bold",children:k(c.price)}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(X,{onClick:F,variant:"danger",className:"mr-2 count",children:"-"}),e.jsx("span",{className:"border p-2 px-3 rounded-2 mx-1",children:A}),e.jsx(X,{onClick:B,variant:"primary",className:"ml-2 count",children:"+"})]}),"   ",e.jsx(X,{type:"button",style:{background:"#1BA786"},onClick:q,disabled:c.stock==0||L.role==="admin",children:"Add to Cart"})]}),e.jsx("hr",{}),e.jsx(ps,{responsive:!0,borderless:!0,children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{width:"150px"},children:e.jsx("span",{style:{fontWeight:"700"},children:"Status:"})}),e.jsx("td",{children:e.jsx("p",{className:"m-0",children:c.stock>0?e.jsx("span",{id:"stock_status",className:"text-success",children:"In Stock "}):e.jsx("span",{id:"stock_status",className:"text-danger",children:"Out of Stock "})})})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{width:"150px"},children:e.jsx("span",{style:{fontWeight:"700"},children:"Product Type:"})}),e.jsx("td",{children:c.type})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{width:"150px"},children:e.jsx("span",{style:{fontWeight:"700"},children:"Brand:"})}),e.jsx("td",{children:c.brand})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{width:"150px"},children:e.jsx("span",{style:{fontWeight:"700"},children:"Category:"})}),e.jsx("td",{children:c.category})]})]})}),e.jsx("hr",{}),e.jsx("h5",{className:"mt-2",children:"About this Item:"}),e.jsx("p",{children:c.description}),e.jsx("hr",{}),H?e.jsx(X,{disabled:!E,id:"review_btn",type:"button",className:"mt-4",onClick:h,children:"Submit Your Review"}):e.jsx("div",{className:"alert alert-danger mt-5",children:"Login to Post Review"}),c.reviews&&c.reviews.length>0?e.jsx(ws,{reviews:c.reviews}):"",e.jsxs(J,{show:n,onHide:m,centered:!0,children:[e.jsx(J.Header,{closeButton:!0,children:e.jsx(J.Title,{children:"Submit Review"})}),e.jsx(J.Body,{className:"",children:e.jsxs("form",{onSubmit:W,children:[e.jsx("ul",{className:"stars list-inline d-flex mt-1 align-items-center justify-content-center",children:[1,2,3,4,5].map((f,I)=>e.jsx("li",{className:`star ${f<=j?"orange":""}`,onClick:()=>v(f),onMouseOver:x=>x.target.classList.add("yellow"),onMouseOut:x=>x.target.classList.remove("yellow"),value:f,children:e.jsx("i",{className:"fa fa-star"})},I))}),e.jsx(je.Group,{children:e.jsx(je.Control,{onChange:f=>b(f.target.value),value:S,as:"textarea",rows:3,placeholder:"Write your review"})})," :",e.jsx(X,{diabled:K==="loading",className:"float-right review-btn px-4 text-white",type:"submit",children:"Submit"})]})})]})]})]})})});return e.jsxs(t.Fragment,{children:[e.jsx(ds,{title:c?c.name:"Product Page"}),e.jsx("div",{className:"mt-5",children:us(K,c,p,Z)})]})};export{Rs as default};
